import "hash"
rule Planet_Stealer{
    meta:
    author = "Kerime Gencay"
    description = "Planet Stealer Rule"
    file_name = "planet.exe"
    hash = "f72f063babd357ccdc6c346191a305b9"
strings:
    $str1 = "ReflexiveKey" 
    $str2 = "linktimehash" 
    $str3 = "dequeueSudoG" 
    $str4 = "atomicstatus" 
    $str5 = "CreateCRL" 
    $str6 = "GyH1NanND0"
    $str7 = "ProtoMajor" 
    $str8 = "PostalCode"
    $str9 = "EsdhemgyNay"
    $str10 = "IsSingleIP"

    $opc1 = {55 48 89 E5 48 83 EC 50 48 89 44 24 60 48 89 5C 24 68 48 8B 0D 77 96 DF 00 48 85 C9 75 06 31 C9 31 D2 EB 15}
    $opc2 = {E8 B7 45 01 00 48 89 D9 48 89 C2 48 8B 44 24 60 48 8B 5C 24 68 48 89 4C 24 10 48 89 54 24 18 4C 89 74 24 20 49 8B 76 30 FF 86 D8 00 00 00 49 C7 46 10 DE FA FF FF 41 C6 86 B7 00 00 00 01 E8 39 FF FF FF}
    $opc3 = {48 8D 15 38 27 29 00 0F B6 34 10 0F B6 BC 04 84 01 00 00 01 FE 40 88 B4 04 84 01 00 00 48 FF C0 48 83 F8 0F 7C DA}
    $opc4 = {75 0A E8 E8 6C 00 00 E8 83 1D 00 00 48 8B 73 50 48 39 F7 75 0A E8 F5 6C 00 00 E8 70 1D 00 00 48 8B 44 24 08}
    

condition:
    uint16(0) == 0x5A4D and (any of ($str*,$opc*))
}
