rule Detect_SwiftSlicer_wiper: SwiftSlicer wiper
{
 meta:
    description = "Detect_SwiftSlicer_wiper"
    author = "ThreatMon"
    date = "2023-02-1"
    hash = "1db93ee81050da0ba413543f9fbc388499a466792f9a54ea6f1bbdb712ba9690"
 strings:
    $wipe_fun = {89 5C 24 ?? 89 74 24 ?? 89 6C 24 ?? 89 54 24 ?? C6 84
    2 4 [4] ?? C7 84 24 [4] [4] C7 84 24 [4] [4] C7 84 24 [4] [4] 8D 84 24 [4]
    89 04 24 C7 44 24 [4] ?? C7 44 24 [4] ?? E8 [4] 8B 05 [4] 8B 0D [4] 8B 54
    24 ?? 89 04 24 89 4C 24 ?? 89 54 24 ?? E8 [4] 8B 44 24 ?? 89 44 24 ?? 8B
    0D [4] 8B 15 [4] 89 54 24 ?? 89 0C 24 E8 [4] 8B 05 [4] 89 C1 8B 44 24 ??
    89 C3 F7 E1 8B 6C 24 ?? 89 EE 29 C5 8B 7C 24 ?? 0F AF CF 01 D1 8B 15 [4]
    0F AF D3 01 D1 29 C6 8B 44 24 ?? 19 C8 F2 0F 10 44 24 ?? F2 0F 11 44 24 ??
    89 44 24 ?? 89 2C 24 E8 [4] F2 0F 10 44 24 ?? F2 0F 11 04 24 E8 [4] F2 0F
    10 44 24 ?? F2 0F 11 04 24 E8 [4] 8B 44 24 ?? 89 44 24 ?? 8B 4C 24 ?? 89
    4C 24 ?? 8B 54 24 ?? 89 54 24 ?? 8B 5C 24 ?? 89 1C 24 E8 [4] 8B 44 24 ??
    8B 4C 24 ?? 8B 54 24 ?? 85 D2}

    $s0 = "main.wipe" ascii
    $s1 = "main.walkFunc" ascii
    $s2 = "main.GetLogicalDriveStrings" ascii
    $s3 = "main.lookupPrivilegeName" ascii
    $s4 = "main.LoadDLL" ascii
    $s5 = "main.GetSystemDirectory" ascii

 condition:
    uint16(0) == 0x5A4D and all of them
}
